#!/usr/bin/env ruby
$LOAD_PATH << './lib'

require 'optparse'
require 'nmax'

options = {}

OptionParser.new do |opt|
  opt.banner = "Usage:\n    nmax [N] [OPTIONS]"
  opt.separator "\nOptions"

  opt.on('-n', '--n [n]', Integer, 'Count of biggest numbers') do |n|
    options[:n] = n
  end

  opt.on('-f', '--file [file]', String, 'Input file') do |file|
    options[:stream] = IO.open(file)
  end

  opt.on('-v', '--version', 'Show version') do
    puts NMax::VERSION
    exit
  end

  opt.on('-h', '--help', 'Show this help') do
    puts opt
    exit
  end

  if ARGV.empty? && options.empty?
    opt.on do
      puts opt
      exit
    end
  end
end.parse!

options[:stream] ||= STDIN
options[:n] ||= ARGV[0].to_i

puts NMax.get(stream: options[:stream], n: options[:n])
